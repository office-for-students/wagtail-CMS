{% extends "base.html" %}
{% include 'courses/partials/sticky_header.html' %}
{% load staticfiles sass_tags wagtailcore_tags discover_uni_tags %}


{% block extra_css %}
    <link href="{% sass_src 'scss/course_comparison.scss' %}?{% code_version %}" rel="stylesheet" type="text/css">
    <link href="{% sass_src 'scss/home.scss' %}?{% code_version %}" rel="stylesheet" type="text/css">
    <link href="{% sass_src 'scss/course_detail.scss' %}?{% code_version %}" rel="stylesheet" type="text/css">
{% endblock %}

{% block extra_js %}
    <script type="text/javascript" src="{% static 'js/course_detail_accordions.js' %}?{% code_version %}"></script>
    <script type="text/javascript" src="{% static 'js/ratings.js' %}?{% code_version %}"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/highcharts-more.js"></script>
    <script src="https://code.highcharts.com/modules/solid-gauge.js"></script>
    <script src="https://code.highcharts.com/modules/accessibility.js"></script>
    <script type="text/javascript" src="{% static 'js/doughnut_chart.js' %}?{% code_version %}"></script>
    <script type="text/javascript" src="{% static 'js/bar_chart.js' %}?{% code_version %}"></script>
    <script type="text/javascript" src="{% static 'js/label_explanation_popups.js' %}?{% code_version %}"></script>
    <script type="text/javascript" src="{% static 'js/overview_blocks.js' %}?{% code_version %}"></script>

    <script>
        var compare_list = JSON.parse(localStorage.getItem("compareCourses"));
        var saved_courses = JSON.parse(localStorage.getItem("comparisonCourses"));
        var dataset = [];

    </script>

{% endblock %}

{% block content %}

    <div class="comparison d-sm-block mb-5">
        <div class="comparison__body pt-1">

            <h2 class="comparison__heading">
                {{ page.compare_heading }}
            </h2>

            <div class="comparison__top-container">
                <div class="comparison__top-container-need-help-box">
                    <h4>Need help choosing?</h4>
                    <p>Search our guidelines for help making the best decision for you.</p>
                    <p style="margin-bottom: 0px;">Go to <strong class="blue-text">Information and advice</strong></p>
                </div>
                <div class="comparison__top-container-add-btn">

                    <a id="addCourses" href="/{% get_translation key='bookmarks-manage' language=page.get_language %}/"
                       class="comparison__top-container-add-btn-add-courses-button">
                        <span style="font-size:20px;">+</span>
                        <span>&nbsp; Add saved course</span>
                    </a>

                    <p class="comparison__top-container-add-btn-compare-text">Compare up
                        to 7 courses</p>
                </div>

            </div>
            <!-- Course Search box -->
            <div id="courseSearchContainer" class="course-search-container hidden">
                <div class="no_courses_saved">
                    No courses saved. To compare courses, search for and save courses you're interested in.
                </div>
                <div class="course_comparison-search bg-white pb-5">
                    <div class="row course_compare_search">
                        {% include 'coursefinder/partials/coursesearch/searchbox.html' %}
                        <div class="col-12 d-block d-lg-none mx-auto text-center">
                            <hr class="dash"/>
                        </div>
                        {% include 'coursefinder/partials/coursesearch/coursewizard.html' %}
                    </div>
                </div>
            </div>
            <!-- Course Search box end -->
            <div class="course-detail__course-container">
                {% if courses %}
                    <div class="course-detail__course-selected">
                        {{ courses|length }} courses selected
                    </div>
                    <form id="compareForm" method="GET"
                          action="/{% get_translation key='course_comparison_link' language=page.get_language %}">
                        <div id="hiddenCourseCompare"></div>
                    </form>

                    <div class="course-detail__course-container-pills">
                        <div class="course-detail__course-container-pills-slider"
                             onclick="bottom_display -= 1; scrollDisplay();" id="slideLeft">
                            <i class="course-detail__course-container-pills-slider-arrow fas fa-chevron-left"></i>
                        </div>
                        {% for course in courses %}
                            {% include 'courses/partials/course_comparison_overview.html' %}
                        {% endfor %}
                        <div class="course-detail__course-container-pills-slider single-arrow"
                             onclick="bottom_display += 1; scrollDisplay();" id="slideRight">
                            <i class="course-detail__course-container-pills-slider-arrow fas fa-chevron-right"></i>
                        </div>
                    </div>
                {% else %}
                    <div class="course-detail__course-none-selected">
                        <div class="course-detail__course-none-selected-header">No courses selected</div>
                        <p>Add 2 courses to use the comparison tool</p>
                    </div>
                {% endif %}
            </div>
            {% if courses %}
            <div id="course-info-container">
                {% with dataset=courses_data.0.course_details %}
                    <div class="course_comparison-table__row-header">
                        {{ dataset.title }}
                    </div>
                    {% for item, value in dataset.dataset.items %}
                        {% if forloop.counter == 3 %}
                            <!-- Hidden content start -->
                            <div class="accordion">
                            <div class="accordion-body">

                        {% endif %}
                    <script>dataset.push("{{value.title}}")</script>
                    {% include 'courses/partials/comparison_courses_row.html' with title=value.title values=value.values %}
                    {% if forloop.last %}
                        </div>
                        <!-- Hidden content end -->
                        <!-- Show more start-->
                        {% with action=dataset.call_to_action.0.show_more %}
                            <div tabindex="0" role="button" aria-label="{{ action.affirmative }}"
                                 class="accordion-header">
                            <div class="accordion-title">
                            <div class="accordion-header course_comparison-table__row-header">
                            <i class="fas fa-chevron-down expand chevron" alt="expand"
                               aria-label="{{ action.affirmative }}"></i>
                            <i class="fas fa-chevron-up collapse chevron" alt="collapse"
                               aria-label="{{ action.negative }}"></i>
                            <span class="expand">{{ action.affirmative }}</span>
                            <span class="collapse">{{ action.negative }}</span>
                        {% endwith %}
                    </div>
                    </div>

                    </div>
                        <!-- show more end -->
                    {% endif %}
                    {% endfor %}
                {% endwith %}
                </div>

                <div class="course-detail__body">
                    <div class="course-detail__accordion-block">
                        {% for accordion in page.accordions %}
                            {% create_list course1 course2 as courses %}
                            {% should_show_accordion courses accordion.value.data_set as show_accordion %}
                            {% if show_accordion %}

                                <div id="{{ accordion.value.data_set }}"
                                     class="my-3 course-detail__accordion sticky-top">
                                    <button class="course-detail__accordion-heading"
                                            onclick="toggle_icon('accordion_icon_{{ forloop.counter }}')">
                                <span class="float-left">
                                    <h2 id="course-detail__accordion-heading-{{ forloop.counter }}"
                                        aria-controls="course-detail__accordion-body-{{ forloop.counter }}"
                                        aria-label="Show {{ accordion.value.heading }} content"
                                        aria-expanded="false">
                                    {{ accordion.value.heading }}

                                </h2>
                                </span>
                                        <span class="float-right pr-3">
                                    <i id="accordion_icon_{{ forloop.counter }}"
                                       class="fas fa-plus text-right text-white"></i>
                                 </span>

                                    </button>

                                    <div id="course-detail__accordion-body-{{ forloop.counter }}"
                                         class="course-detail__accordion-body "
                                         aria-labelledby="course-detail__accordion-heading-{{ forloop.counter }}">
                                        <div class="bg-light text-dark">Lorem ipsum dolor sit amet, consectetur
                                            adipiscing
                                            elit. Nunc vel hendrerit purus. Aenean vestibulum leo eu risus luctus, ut
                                            luctus
                                            eros elementum. Nam ut ipsum mauris. Suspendisse lobortis id mi sit amet
                                            fermentum. Vestibulum egestas ut orci dapibus gravida. Interdum et malesuada
                                            fames ac ante ipsum primis in faucibus. Suspendisse maximus orci et libero
                                            gravida, in mattis felis efficitur. Duis vehicula lectus et faucibus
                                            tincidunt.
                                            Mauris luctus odio neque, nec porta lacus pretium vitae. Suspendisse euismod
                                            scelerisque diam vitae vehicula. Aliquam sagittis gravida est, id vulputate
                                            massa aliquet vel. Nunc venenatis sagittis lorem, a dignissim ligula porta
                                            et.
                                            Integer sed tellus ac leo sodales volutpat sit amet sit amet purus. Praesent
                                            imperdiet, arcu id tincidunt fringilla, nisl lorem sollicitudin odio,
                                            euismod
                                            viverra velit nisi sit amet libero. In magna purus, faucibus vitae rutrum
                                            nec,
                                            tincidunt at dui.

                                            Duis in dolor iaculis quam congue porta. Proin ex odio, imperdiet a
                                            consectetur
                                            eget, mattis eget diam. Morbi ultrices arcu vel mi porta, eu tincidunt augue
                                            congue. Aliquam in vehicula quam. Praesent a sem scelerisque, dignissim nibh
                                            vel, interdum nunc. Quisque ullamcorper tincidunt turpis. Vestibulum ante
                                            ipsum
                                            primis in faucibus orci luctus et ultrices posuere cubilia curae;

                                            Nulla volutpat finibus tellus a malesuada. Mauris dapibus quam id sem
                                            aliquam
                                            accumsan. Suspendisse et turpis nec erat varius tristique eget non enim.
                                            Vivamus
                                            sed eleifend lorem. Vivamus et arcu metus. Sed odio nibh, volutpat ac
                                            gravida
                                            quis, porta eget turpis. Vivamus at rutrum ipsum. Praesent dictum sem quis
                                            egestas mollis. Nullam fringilla tincidunt tortor at vehicula. Ut erat enim,
                                            ultrices et placerat sed, luctus ac purus. Nulla quis ornare elit, eget
                                            molestie
                                            ex. Ut sem tortor, imperdiet vitae auctor vitae, pretium in nulla. Fusce et
                                            accumsan justo, eget eleifend diam. Aenean eu lorem ligula. Vivamus lobortis
                                            augue est, quis convallis enim scelerisque nec. Suspendisse posuere suscipit
                                            ipsum, ut mollis odio pretium et.

                                            Vestibulum mi augue, dapibus non dignissim et, porttitor sit amet dolor.
                                            Integer
                                            ligula diam, fringilla in feugiat et, placerat eget elit. Phasellus porta
                                            molestie ligula. Donec quis congue odio. Suspendisse id nunc a sem tristique
                                            placerat. Nullam porta tristique lacus non rhoncus. Curabitur a ipsum vel
                                            metus
                                            mollis tempus sit amet ac purus.

                                            Nulla facilisi. Cras tellus neque, mollis sed sodales pellentesque,
                                            tristique at
                                            nunc. Fusce elementum porttitor ex. Sed purus quam, faucibus id feugiat a,
                                            tempus a nisl. Etiam et ex malesuada, elementum nibh quis, euismod orci. In
                                            dignissim varius metus et elementum. Pellentesque eu fringilla felis, a
                                            maximus
                                            tellus. Vestibulum ut nisl scelerisque, sollicitudin mauris et, maximus
                                            sapien.
                                            Integer molestie laoreet elementum. Quisque id ipsum id magna dignissim
                                            semper.
                                            Cras vestibulum diam porttitor urna fermentum interdum. Pellentesque
                                            lacinia,
                                            elit tincidunt auctor faucibus, lacus elit sagittis mi, at iaculis justo
                                            lorem
                                            eget arcu. Sed vel posuere ligula, vulputate ullamcorper dolor. Suspendisse
                                            vitae bibendum dolor, id tincidunt justo. Nam eu egestas tellus.
                                        </div>
                                    </div>
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>

                <!-- {% include 'courses/partials/compare-popup-bar.html' %} -->
            </div>
        </div>
    </div>
    {% if courses %}
        <script type="text/javascript" src="{% static 'js/arrows.js' %}?{% code_version %}"></script>
    {% endif %}
    <script>
        var course_search_container = document.getElementById("courseSearchContainer");
        if (!(saved_courses)) {
            course_search_container.classList.remove("hidden")
        }
    </script>

{% endblock %}

